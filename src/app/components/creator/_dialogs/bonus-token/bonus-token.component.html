<div *ngIf="isLoading"
     fxLayout="column"
     fxLayoutAlign="center"
     fxFill>
  <div fxLayout="row"
       fxLayoutAlign="center">
    <app-mat-spinner-overlay diameter="80"
                             strokeWidth="8"></app-mat-spinner-overlay>
  </div>
</div>

<div mat-dialog-content xmlns="http://www.w3.org/1999/html">
  <h2 class="oldtypo-h2">{{'room-page.bonus-token-header' | translate }}</h2>
  <h3 class="oldtypo-h3">&raquo;{{room.name}}&laquo;</h3>
  <h3 class="oldtypo-h3">{{ 'room-page.session-id' | translate}}: {{ room.shortId }}</h3>
  <div *ngIf="bonusTokens.length >= 1">
    <div class="validator">
      <mat-form-field>
        <input appAccessibilityEscapedInput
               (keyup)="inputChanged($event)"
               (input)="inputChanged($event)"
               matInput
               class="input-block"
               type="text"
               maxlength="14"
               name="roomName"
               aria-labelledby="room-name-input"/>
        <mat-placeholder class="placeholder">{{ 'room-page.hint' | translate }}</mat-placeholder>
        <mat-hint align="end"
                  class="count"><span aria-hidden="true">{{ value.length }} / 8</span></mat-hint>
      </mat-form-field>
      <button *ngIf="!valid" (click)="navToCommentByValue()"
              matTooltip="{{ 'room-page.nav-to-comment' | translate }}"
              mat-stroked-button disabled>
        Go to Question
      </button>
      <button *ngIf="valid" (click)="navToCommentByValue()"
              matTooltip="{{ 'room-page.nav-to-comment' | translate }}"
              mat-stroked-button class="enabled">
        Go to Question
      </button>
    </div>


  <div >
    <div class="table-container">
      <table #roomTable
             matSort
             (matSortChange)="sortData($event)"
             mat-table
             [dataSource]="tableDataSource"
             class="list-entries">

             <!-- number -->
            <ng-container matColumnDef="questionNumber"
             aria-hidden="true">
              <th mat-header-cell
                mat-sort-header
                sortActionDescription="Sort by questionNumber"
                *matHeaderCellDef
                style="width: 35%">
                {{ 'token-validator.questionNumber' | translate }}
              </th>
              <td mat-cell
                  class="clickable"
                  *matCellDef="let bonusToken"
                  (click)="navToCommentByValue()">
                <span matBadge
                  matBadgePosition="before"
                  matBadgeSize="small"
                  matBadgeOverlap="false">
                  &raquo;{{bonusTokens.questionNumber}}&laquo;
                </span>
              </td>
            </ng-container>

            <!-- token -->
            <ng-container matColumnDef="token"
                          aria-hidden="true">
              <th mat-header-cell
                  mat-sort-header
                  sortActionDescription="Sort by token"
                  *matHeaderCellDef
                  style="width: 35%">
                {{ 'token-validator.token' | translate }}
              </th>
              <td mat-cell
                  class="clickable"
                  *matCellDef="let bonusToken"
                  (click)="navToCommentByValue()">
                {{bonusToken.token}}
              </td>
            </ng-container>


            <!-- timestamp -->
            <ng-container matColumnDef="timestamp"
            aria-hidden="true">
              <th mat-header-cell
                  mat-sort-header
                  sortActionDescription="Sort by timestamp"
                  *matHeaderCellDef
                  style="width: 25%">
                {{ 'token-validator.timestamp' | translate }}
              </th>
              <td mat-cell
                  class="clickable"
                  *matCellDef="let bonusToken"
                  (click)="navToCommentByValue()">
                {{bonusToken.timestamp}}
              </td>
            </ng-container>


        <tr mat-header-row
          *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row
          *matRowDef="let row; columns: displayedColumns;"></tr>

      </table>
    </div>
  </div>

  </div>
  <div *ngIf="bonusTokens.length === 0">
    <p>{{'room-page.no-bonus' | translate }}
    </p>
  </div>
  <div fxLayoutAlign="center center" *ngIf="bonusTokens.length > 1">
    <button mat-button class="delete" (click)="openDeleteAllBonusDialog()">
      <mat-icon class="material-icons-outlined">delete</mat-icon>
      {{'room-page.delete-all-tokens' | translate}}
    </button>
  </div>
</div>

<ars-row ars-flex-box>
  <button
    mat-flat-button
    class="export-button"
    (click)="export()">
    <mat-icon>file_download</mat-icon>
    {{ 'room-page.export-bonus-archive' | translate }}
  </button>
</ars-row>

<ars-row ars-flex-box class="action-button-container">
  <ars-col>
    <button
      mat-flat-button
      class="help-button"
      (click)="openHelp()">
      <mat-icon>question_mark</mat-icon>
      {{ 'explanation.label' | translate}}
    </button>
  </ars-col>
  <ars-col>
    <app-dialog-action-buttons
      buttonsLabelSection="content"
      [spacing]="false"
      [cancelButtonClickAction]="buildDeclineActionCallback()">
    </app-dialog-action-buttons>
  </ars-col>
</ars-row>
